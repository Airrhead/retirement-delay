// 等待DOM加载完成
document.addEventListener('DOMContentLoaded', function() {
    // 初始化 ECharts 实例
    const chartDom = document.getElementById('sent');
    if (!chartDom) {
        console.error('Cannot find element with id "sent"');
        return;
    }
    
    const chart = echarts.init(chartDom);

    // 数据直接嵌入
    const data = {
        "dates": [
          "2023-11-26",
          "2023-11-28",
          "2023-11-29",
          "2023-11-30",
          "2023-12-01",
          "2023-12-02",
          "2023-12-03",
          "2023-12-04",
          "2023-12-05",
          "2023-12-06",
          "2023-12-08",
          "2023-12-09",
          "2023-12-10",
          "2023-12-11",
          "2023-12-13",
          "2023-12-14",
          "2023-12-15",
          "2023-12-17",
          "2023-12-18",
          "2023-12-19",
          "2023-12-20",
          "2023-12-21",
          "2023-12-22",
          "2023-12-23",
          "2023-12-25",
          "2023-12-26",
          "2023-12-27",
          "2023-12-28",
          "2023-12-29",
          "2023-12-30",
          "2023-12-31",
          "2024-01-01",
          "2024-01-02",
          "2024-01-03",
          "2024-01-04",
          "2024-01-05",
          "2024-01-07",
          "2024-01-08",
          "2024-01-09",
          "2024-01-10",
          "2024-01-11",
          "2024-01-12",
          "2024-01-13",
          "2024-01-15",
          "2024-01-16",
          "2024-01-17",
          "2024-01-19",
          "2024-01-20",
          "2024-01-21",
          "2024-01-22",
          "2024-01-24",
          "2024-01-25",
          "2024-01-27",
          "2024-01-28",
          "2024-01-29",
          "2024-01-30",
          "2024-01-31",
          "2024-02-01",
          "2024-02-02",
          "2024-02-03",
          "2024-02-05",
          "2024-02-06",
          "2024-02-07",
          "2024-02-08",
          "2024-02-09",
          "2024-02-11",
          "2024-02-13",
          "2024-02-14",
          "2024-02-15",
          "2024-02-20",
          "2024-02-21",
          "2024-02-22",
          "2024-02-23",
          "2024-02-24",
          "2024-02-26",
          "2024-02-27",
          "2024-02-28",
          "2024-02-29",
          "2024-03-01",
          "2024-03-02",
          "2024-03-03",
          "2024-03-04",
          "2024-03-05",
          "2024-03-06",
          "2024-03-07",
          "2024-03-08",
          "2024-03-09",
          "2024-03-10",
          "2024-03-11",
          "2024-03-12",
          "2024-03-13",
          "2024-03-14",
          "2024-03-15",
          "2024-03-16",
          "2024-03-17",
          "2024-03-18",
          "2024-03-19",
          "2024-03-20",
          "2024-03-21",
          "2024-03-22",
          "2024-03-23",
          "2024-03-24",
          "2024-03-25",
          "2024-03-26",
          "2024-03-27",
          "2024-03-28",
          "2024-03-29",
          "2024-03-30",
          "2024-03-31",
          "2024-04-01",
          "2024-04-02",
          "2024-04-03",
          "2024-04-04",
          "2024-04-05",
          "2024-04-06",
          "2024-04-07",
          "2024-04-08",
          "2024-04-09",
          "2024-04-10",
          "2024-04-11",
          "2024-04-12",
          "2024-04-14",
          "2024-04-15",
          "2024-04-16",
          "2024-04-17",
          "2024-04-18",
          "2024-04-19",
          "2024-04-20",
          "2024-04-21",
          "2024-04-22",
          "2024-04-23",
          "2024-04-24",
          "2024-04-25",
          "2024-04-26",
          "2024-04-27",
          "2024-04-28",
          "2024-04-30",
          "2024-05-01",
          "2024-05-02",
          "2024-05-03",
          "2024-05-07",
          "2024-05-08",
          "2024-05-09",
          "2024-05-10",
          "2024-05-11",
          "2024-05-12",
          "2024-05-13",
          "2024-05-14",
          "2024-05-15",
          "2024-05-16",
          "2024-05-17",
          "2024-05-18",
          "2024-05-19",
          "2024-05-20",
          "2024-05-21",
          "2024-05-22",
          "2024-05-23",
          "2024-05-24",
          "2024-05-25",
          "2024-05-26",
          "2024-05-27",
          "2024-05-28",
          "2024-05-29",
          "2024-05-30",
          "2024-05-31",
          "2024-06-01",
          "2024-06-02",
          "2024-06-03",
          "2024-06-04",
          "2024-06-05",
          "2024-06-06",
          "2024-06-07",
          "2024-06-08",
          "2024-06-09",
          "2024-06-10",
          "2024-06-11",
          "2024-06-12",
          "2024-06-13",
          "2024-06-14",
          "2024-06-15",
          "2024-06-17",
          "2024-06-18",
          "2024-06-19",
          "2024-06-20",
          "2024-06-21",
          "2024-06-22",
          "2024-06-23",
          "2024-06-24",
          "2024-06-25",
          "2024-06-26",
          "2024-06-27",
          "2024-06-28",
          "2024-06-29",
          "2024-06-30",
          "2024-07-03",
          "2024-07-04",
          "2024-07-05",
          "2024-07-06",
          "2024-07-07",
          "2024-07-08",
          "2024-07-09",
          "2024-07-11",
          "2024-07-12",
          "2024-07-13",
          "2024-07-14",
          "2024-07-15",
          "2024-07-17",
          "2024-07-18",
          "2024-07-19",
          "2024-07-20",
          "2024-07-21",
          "2024-07-23",
          "2024-07-24",
          "2024-07-25",
          "2024-07-26",
          "2024-07-27",
          "2024-07-28",
          "2024-07-29",
          "2024-07-30",
          "2024-07-31",
          "2024-08-01",
          "2024-08-02",
          "2024-08-03",
          "2024-08-04",
          "2024-08-05",
          "2024-08-06",
          "2024-08-07",
          "2024-08-08",
          "2024-08-09",
          "2024-08-10",
          "2024-08-11",
          "2024-08-12",
          "2024-08-13",
          "2024-08-14",
          "2024-08-15",
          "2024-08-16",
          "2024-08-17",
          "2024-08-18",
          "2024-08-19",
          "2024-08-20",
          "2024-08-21",
          "2024-08-22",
          "2024-08-23",
          "2024-08-24",
          "2024-08-25",
          "2024-08-26",
          "2024-08-27",
          "2024-08-28",
          "2024-08-29",
          "2024-08-31",
          "2024-09-01",
          "2024-09-02",
          "2024-09-03",
          "2024-09-04",
          "2024-09-05",
          "2024-09-06",
          "2024-09-07",
          "2024-09-08",
          "2024-09-09",
          "2024-09-10",
          "2024-09-11",
          "2024-09-25",
          "2024-09-26",
          "2024-09-27",
          "2024-09-28",
          "2024-09-29",
          "2024-09-30",
          "2024-10-01",
          "2024-10-02",
          "2024-10-03",
          "2024-10-05",
          "2024-10-06",
          "2024-10-07",
          "2024-10-08",
          "2024-10-09",
          "2024-10-10",
          "2024-10-11",
          "2024-10-12",
          "2024-10-13",
          "2024-10-14",
          "2024-10-15",
          "2024-10-16",
          "2024-10-17",
          "2024-10-18",
          "2024-10-19",
          "2024-10-20",
          "2024-10-21",
          "2024-10-22",
          "2024-10-23",
          "2024-10-24",
          "2024-10-25",
          "2024-10-26",
          "2024-10-27",
          "2024-10-28",
          "2024-10-29",
          "2024-10-30",
          "2024-10-31"
        ],
        "positive": [
          1,
          1,
          2,
          3,
          4,
          4,
          5,
          6,
          7,
          9,
          9,
          11,
          12,
          13,
          14,
          14,
          14,
          14,
          14,
          14,
          15,
          16,
          16,
          18,
          19,
          19,
          23,
          24,
          25,
          26,
          27,
          27,
          28,
          28,
          28,
          28,
          28,
          29,
          39,
          42,
          43,
          46,
          47,
          47,
          47,
          47,
          47,
          48,
          48,
          48,
          48,
          48,
          49,
          52,
          52,
          52,
          52,
          54,
          54,
          54,
          54,
          55,
          55,
          56,
          56,
          56,
          56,
          57,
          59,
          59,
          59,
          64,
          87,
          88,
          90,
          91,
          92,
          93,
          94,
          98,
          98,
          107,
          107,
          109,
          112,
          120,
          120,
          120,
          120,
          120,
          122,
          124,
          125,
          125,
          128,
          131,
          133,
          134,
          134,
          134,
          135,
          135,
          138,
          138,
          139,
          142,
          144,
          144,
          144,
          145,
          146,
          148,
          148,
          148,
          148,
          149,
          150,
          150,
          150,
          150,
          150,
          151,
          151,
          152,
          152,
          152,
          152,
          152,
          155,
          157,
          157,
          158,
          162,
          162,
          162,
          162,
          162,
          162,
          162,
          162,
          162,
          162,
          164,
          164,
          164,
          164,
          165,
          165,
          167,
          167,
          168,
          169,
          171,
          172,
          175,
          176,
          179,
          179,
          179,
          181,
          181,
          181,
          181,
          182,
          182,
          185,
          186,
          186,
          187,
          188,
          189,
          189,
          190,
          191,
          191,
          192,
          193,
          194,
          195,
          196,
          196,
          197,
          198,
          198,
          198,
          198,
          198,
          198,
          198,
          200,
          201,
          201,
          201,
          202,
          203,
          203,
          204,
          205,
          206,
          206,
          206,
          206,
          208,
          208,
          208,
          208,
          209,
          210,
          211,
          211,
          233,
          233,
          233,
          245,
          252,
          255,
          255,
          256,
          256,
          256,
          258,
          262,
          262,
          264,
          266,
          267,
          268,
          268,
          268,
          270,
          271,
          278,
          285,
          288,
          288,
          290,
          292,
          292,
          295,
          297,
          300,
          302,
          303,
          306,
          309,
          313,
          313,
          313,
          314,
          315,
          316,
          316,
          316,
          316,
          317,
          318,
          319,
          321,
          321,
          407,
          407,
          409,
          412,
          416,
          418,
          422,
          428,
          432,
          437,
          437,
          437,
          437,
          438,
          439,
          439,
          440,
          440,
          442,
          442,
          446,
          449,
          450,
          451,
          451,
          451,
          453,
          453,
          455,
          456,
          457,
          457,
          457,
          457,
          458,
          458,
          462,
          466
        ],
        "negative": [
          0,
          1,
          2,
          2,
          4,
          5,
          6,
          8,
          12,
          14,
          17,
          18,
          20,
          25,
          28,
          31,
          35,
          39,
          41,
          42,
          49,
          51,
          52,
          53,
          56,
          59,
          87,
          94,
          97,
          98,
          98,
          101,
          101,
          104,
          107,
          109,
          112,
          132,
          228,
          250,
          252,
          252,
          254,
          255,
          261,
          262,
          266,
          268,
          270,
          275,
          279,
          284,
          285,
          287,
          290,
          297,
          299,
          302,
          307,
          309,
          310,
          311,
          312,
          314,
          316,
          318,
          321,
          325,
          332,
          335,
          338,
          448,
          993,
          1009,
          1061,
          1069,
          1083,
          1093,
          1113,
          1125,
          1129,
          1192,
          1204,
          1214,
          1222,
          1260,
          1276,
          1279,
          1284,
          1288,
          1305,
          1313,
          1315,
          1316,
          1326,
          1333,
          1335,
          1338,
          1354,
          1360,
          1371,
          1376,
          1397,
          1401,
          1417,
          1433,
          1438,
          1439,
          1445,
          1449,
          1453,
          1457,
          1458,
          1461,
          1463,
          1468,
          1478,
          1481,
          1483,
          1490,
          1491,
          1494,
          1499,
          1500,
          1511,
          1524,
          1529,
          1532,
          1566,
          1584,
          1591,
          1592,
          1610,
          1617,
          1628,
          1631,
          1634,
          1636,
          1637,
          1639,
          1642,
          1644,
          1656,
          1657,
          1660,
          1663,
          1666,
          1671,
          1673,
          1676,
          1679,
          1686,
          1702,
          1702,
          1703,
          1706,
          1709,
          1710,
          1717,
          1720,
          1724,
          1729,
          1732,
          1737,
          1740,
          1743,
          1745,
          1746,
          1746,
          1749,
          1753,
          1755,
          1760,
          1761,
          1765,
          1767,
          1767,
          1772,
          1779,
          1782,
          1789,
          1791,
          1794,
          1798,
          1803,
          1807,
          1809,
          1812,
          1814,
          1817,
          1821,
          1824,
          1828,
          1830,
          1836,
          1841,
          1854,
          1856,
          1863,
          1866,
          1868,
          1870,
          1873,
          1874,
          1875,
          1879,
          1885,
          1887,
          1889,
          1890,
          2066,
          2070,
          2074,
          2155,
          2203,
          2234,
          2256,
          2276,
          2290,
          2293,
          2320,
          2331,
          2334,
          2344,
          2351,
          2362,
          2373,
          2378,
          2383,
          2391,
          2395,
          2405,
          2414,
          2424,
          2441,
          2449,
          2455,
          2462,
          2477,
          2482,
          2492,
          2497,
          2505,
          2507,
          2513,
          2526,
          2528,
          2537,
          2548,
          2550,
          2554,
          2564,
          2575,
          2585,
          2591,
          2599,
          2605,
          2609,
          2617,
          3344,
          3346,
          3383,
          3407,
          3424,
          3442,
          3465,
          3477,
          3483,
          3488,
          3499,
          3505,
          3507,
          3508,
          3511,
          3512,
          3514,
          3517,
          3520,
          3523,
          3529,
          3541,
          3554,
          3560,
          3563,
          3572,
          3579,
          3587,
          3590,
          3600,
          3610,
          3619,
          3622,
          3627,
          3631,
          3637,
          3642,
          3647
        ]
      };

    const option = {
        tooltip: {
            trigger: 'axis',
            axisPointer: {
                type: 'cross',
                label: {
                    backgroundColor: '#6a7985'
                }
            }
        },
        legend: {
            data: ['积极', '消极'],
            top: '30px'
        },
        grid: {
            left: '3%',
            right: '3%',
            bottom: '10%',
            containLabel: true
        },
        xAxis: [
            {
                type: 'category',
                boundaryGap: false,
                data: data.dates
            }
        ],
        yAxis: [
            {
                type: 'value',
                name: '累积帖子数量'
            }
        ],
        series: [
            {
                name: '积极',
                type: 'line',
                stack: '总量',
                areaStyle: {
                    opacity: 1
                },
                emphasis: {
                    focus: 'series'
                },
                data: data.positive,
                itemStyle: {
                    color: '#6094b4'
                },
                smooth: true
            },
            {
                name: '消极',
                type: 'line',
                stack: '总量',
                areaStyle: {
                    opacity: 1
                },
                emphasis: {
                    focus: 'series'
                },
                data: data.negative,
                itemStyle: {
                    color: '#1d4c85'
                },
                smooth: true,
                markLine: {
                    symbol: 'none',
                    data: [
                        {
                            xAxis: '2023-12-27',
                            lineStyle: {
                                type: 'dashed',
                                color: '#cccccc' // 虚线颜色
                            },
                            label: {
                                show: true,
                                formatter: '复旦教授：\n中国退休年龄还是太早',
                                position: 'insideMiddle',
                                rotate: 0,
                                offset: [0, 190]
                            }
                        },
                        {
                            xAxis: '2024-01-07',
                            lineStyle: {
                                type: 'dashed',
                                color: '#cccccc' // 虚线颜色
                            },
                            label: {
                                show: true,
                                formatter: '社科院专家建议\n尽快调整退休年龄',
                                position: 'insideMiddle',
                                rotate: 0,
                                offset: [0, 140]
                            }
                        },
                        {
                            xAxis: '2024-02-21',
                            lineStyle: {
                                type: 'dashed',
                                color: '#cccccc' // 虚线颜色
                            },
                            label: {
                                show: true,
                                formatter: '《中国养老金发展报告2023》：\n65岁或为延迟退休调整后最终结果',
                                position: 'insideMiddle',
                                rotate: 0,
                                offset: [0, 80]
                            }
                        },
                        {
                            xAxis: '2024-03-03',
                            lineStyle: {
                                type: 'dashed',
                                color: '#cccccc' // 虚线颜色
                            },
                            label: {
                                show: true,
                                formatter: '政协委员冯春林：\n建议返聘退休教师',
                                position: 'insideMiddle',
                                rotate: 0,
                                offset: [0, 20]
                            }
                        },
                        {
                            xAxis: '2024-04-20',
                            lineStyle: {
                                type: 'dashed',
                                color: '#cccccc' // 虚线颜色
                            },
                            label: {
                                show: true,
                                formatter: '人社部专家：\n延迟退休不会导致年轻人就业难',
                                position: 'insideMiddle',
                                rotate: 0,
                                offset: [0, 10]
                            }
                        },
                        {
                            xAxis: '2024-07-20',
                            lineStyle: {
                                type: 'dashed',
                                color: '#cccccc' // 虚线颜色
                            },
                            label: {
                                show: true,
                                formatter: '“90后无论男女都得65岁以后退休”\n在多个网络平台流传，官方辟谣',
                                position: 'insideMiddle',
                                rotate: 0,
                                offset: [0, -40]
                            }
                        },
                        {
                            xAxis: '2024-09-09',
                            lineStyle: {
                                type: 'dashed',
                                color: '#cccccc' // 虚线颜色
                            },
                            label: {
                                show: true,
                                formatter: '《关于实施渐进式延迟法定退休的决定》\n表决通过，正式出台',
                                position: 'insideMiddle',
                                rotate: 0,
                                offset: [0, -150]
                            }
                        },
                    ]
                }
            }
        ]
    };

    // 使用配置项和数据显示图表
    chart.setOption(option);

    // 响应窗口大小变化
    window.addEventListener('resize', function() {
        chart.resize();
    });
});
